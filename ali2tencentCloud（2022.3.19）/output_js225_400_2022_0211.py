
# !/usr/bin/python
# -*- coding: UTF-8 -*-

import os
import datetime
import time

import pymysql
import pandas as pd

from sqlalchemy import create_engine
import pymysql
import pandas as pd




def savedt():
    engine_jsMons = create_engine('mysql+pymysql://root:123456@localhost:3306/JS')
    sql_sp_LJ = 'select {} from js225_400_leverage_2022_0211  ; '
    # df_js225 = pd.read_sql_query(sql_sp_LJ, engine_jsMons)
    # 1.近50条数据里面，超过非空10条就可以！[-3:] 30
    # 2 . 零计数 df_js225["J225"].tolist().count(0)
    #
    get_code = []
    all_code = ['J225', 'J400', 'J1332', 'J1333', 'J1417', 'J1605', 'J1719', 'J1720', 'J1721', 'J1766', 'J1801',
                'J1802', 'J1803', 'J1808', 'J1812', 'J1820', 'J1821', 'J1824', 'J1860', 'J1861', 'J1878', 'J1881',
                'J1893', 'J1911', 'J1925', 'J1928', 'J1942', 'J1951', 'J1959', 'J1963', 'J1973', 'J2002', 'J2121',
                'J2127', 'J2146', 'J2175', 'J2181', 'J2201', 'J2229', 'J2264', 'J2267', 'J2269', 'J2281', 'J2282',
                'J2317', 'J2327', 'J2331', 'J2337', 'J2371', 'J2379', 'J2412', 'J2413', 'J2427', 'J2432', 'J2433',
                'J2501', 'J2502', 'J2503', 'J2531', 'J2587', 'J2593', 'J2651', 'J2670', 'J2702', 'J2768', 'J2782',
                'J2784', 'J2801', 'J2802', 'J2809', 'J2811', 'J2815', 'J2871', 'J2875', 'J2897', 'J2914', 'J3003',
                'J3038', 'J3048', 'J3064', 'J3086', 'J3088', 'J3092', 'J3099', 'J3101', 'J3103', 'J3107', 'J3116',
                'J3141', 'J3148', 'J3167', 'J3231', 'J3244', 'J3254', 'J3288', 'J3289', 'J3291', 'J3349', 'J3360',
                'J3382', 'J3391', 'J3401', 'J3402', 'J3405', 'J3407', 'J3436', 'J3543', 'J3549', 'J3563', 'J3626',
                'J3635', 'J3659', 'J3738', 'J3765', 'J3769', 'J3861', 'J3863', 'J3880', 'J3923', 'J3932', 'J3941',
                'J4004', 'J4005', 'J4021', 'J4042', 'J4043', 'J4061', 'J4063', 'J4088', 'J4091', 'J4151', 'J4182',
                'J4183', 'J4188', 'J4202', 'J4204', 'J4205', 'J4206', 'J4208', 'J4307', 'J4324', 'J4348', 'J4403',
                'J4452', 'J4502', 'J4503', 'J4506', 'J4507', 'J4516', 'J4519', 'J4521', 'J4523', 'J4527', 'J4528',
                'J4536', 'J4543', 'J4552', 'J4553', 'J4568', 'J4578', 'J4587', 'J4612', 'J4613', 'J4631', 'J4661',
                'J4684', 'J4686', 'J4689', 'J4704', 'J4716', 'J4732', 'J4739', 'J4751', 'J4755', 'J4768', 'J4812',
                'J4816', 'J4819', 'J4848', 'J4849', 'J4887', 'J4901', 'J4902', 'J4911', 'J4912', 'J4921', 'J4922',
                'J4927', 'J4967', 'J5019', 'J5020', 'J5021', 'J5101', 'J5105', 'J5108', 'J5110', 'J5201', 'J5202',
                'J5214', 'J5232', 'J5233', 'J5301', 'J5332', 'J5333', 'J5334', 'J5393', 'J5401', 'J5406', 'J5411',
                'J5541', 'J5631', 'J5703', 'J5706', 'J5707', 'J5711', 'J5713', 'J5714', 'J5801', 'J5802', 'J5803',
                'J5857', 'J5929', 'J5947', 'J6005', 'J6028', 'J6035', 'J6055', 'J6098', 'J6103', 'J6113', 'J6134',
                'J6136', 'J6141', 'J6146', 'J6178', 'J6183', 'J6201', 'J6235', 'J6268', 'J6273', 'J6301', 'J6302',
                'J6305', 'J6326', 'J6361', 'J6367', 'J6383', 'J6432', 'J6448', 'J6465', 'J6471', 'J6472', 'J6473',
                'J6479', 'J6501', 'J6503', 'J6504', 'J6506', 'J6532', 'J6544', 'J6586', 'J6594', 'J6645', 'J6670',
                'J6674', 'J6701', 'J6702', 'J6703', 'J6723', 'J6724', 'J6727', 'J6728', 'J6750', 'J6752', 'J6753',
                'J6754', 'J6758', 'J6762', 'J6770', 'J6841', 'J6845', 'J6849', 'J6856', 'J6857', 'J6861', 'J6869',
                'J6902', 'J6920', 'J6923', 'J6952', 'J6954', 'J6965', 'J6971', 'J6976', 'J6981', 'J6988', 'J7003',
                'J7004', 'J7011', 'J7012', 'J7013', 'J7148', 'J7164', 'J7167', 'J7177', 'J7186', 'J7201', 'J7202',
                'J7203', 'J7205', 'J7211', 'J7259', 'J7261', 'J7267', 'J7269', 'J7270', 'J7272', 'J7276', 'J7282',
                'J7309', 'J7313', 'J7419', 'J7453', 'J7459', 'J7516', 'J7532', 'J7550', 'J7564', 'J7575', 'J7649',
                'J7701', 'J7717', 'J7729', 'J7731', 'J7733', 'J7735', 'J7741', 'J7747', 'J7751', 'J7752', 'J7762',
                'J7832', 'J7846', 'J7911', 'J7912', 'J7947', 'J7951', 'J7956', 'J7974', 'J7988', 'J8001', 'J8002',
                'J8015', 'J8020', 'J8031', 'J8035', 'J8053', 'J8056', 'J8058', 'J8088', 'J8111', 'J8113', 'J8194',
                'J8233', 'J8252', 'J8253', 'J8267', 'J8273', 'J8279', 'J8282', 'J8283', 'J8303', 'J8304', 'J8306',
                'J8308', 'J8309', 'J8316', 'J8331', 'J8354', 'J8355', 'J8410', 'J8411', 'J8424', 'J8425', 'J8439',
                'J8473', 'J8570', 'J8572', 'J8585', 'J8591', 'J8593', 'J8595', 'J8601', 'J8604', 'J8628', 'J8630',
                'J8697', 'J8725', 'J8750', 'J8766', 'J8795', 'J8801', 'J8802', 'J8804', 'J8830', 'J8850', 'J8876',
                'J8892', 'J8905', 'J8919', 'J9001', 'J9005', 'J9007', 'J9008', 'J9009', 'J9020', 'J9021', 'J9022',
                'J9042', 'J9062', 'J9064', 'J9065', 'J9069', 'J9086', 'J9090', 'J9101', 'J9104', 'J9107', 'J9142',
                'J9143', 'J9202', 'J9301', 'J9375', 'J9418', 'J9432', 'J9433', 'J9434', 'J9435', 'J9501', 'J9502',
                'J9503', 'J9504', 'J9506', 'J9508', 'J9509', 'J9513', 'J9517', 'J9519', 'J9531', 'J9532', 'J9602',
                'J9613', 'J9627', 'J9678', 'J9684', 'J9697', 'J9719', 'J9735', 'J9744', 'J9766', 'J9787', 'J9810',
                'J9843', 'J9962', 'J9983', 'J9984', 'J9989']

    for item in all_code:
        df_js = pd.read_sql_query(sql_sp_LJ.format(item), engine_jsMons)
        if df_js[item].tolist()[-50:].count("") < 6:
            get_code.append(item)
        else:
            pass
    get_code.append("LastTime")
    sql_sp_f = 'select {0} from js225_400_leverage_2022_0211  ; '
    df_js_f = pd.read_sql_query(sql_sp_f.format(",".join(get_code)), engine_jsMons)
    df_js_f.to_excel("js225_400_leverage_2022_0211.xlsx")




if __name__ == '__main__':
    savedt()


